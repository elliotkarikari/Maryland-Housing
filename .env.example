# =============================================================================
# Maryland Housing Atlas - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values
# cp .env.example .env

# -----------------------------------------------------------------------------
# Database
# -----------------------------------------------------------------------------
# Primary backend for ingest/pipeline writes: databricks | postgres
DATA_BACKEND=databricks

# Databricks SQL Warehouse connection (required when DATA_BACKEND=databricks)
DATABRICKS_SERVER_HOSTNAME=
DATABRICKS_HTTP_PATH=
DATABRICKS_ACCESS_TOKEN=
DATABRICKS_CATALOG=maryland_atlas
DATABRICKS_SCHEMA=default
# Optional prebuilt SQLAlchemy URL (overrides hostname/http_path/token fields)
DATABRICKS_SQLALCHEMY_URL=

# PostgreSQL fallback connection string (used when DATA_BACKEND=postgres)
DATABASE_URL=postgresql://localhost/maryland_atlas
# Or with credentials:
# DATABASE_URL=postgresql://username:password@localhost:5432/maryland_atlas

# -----------------------------------------------------------------------------
# API Keys (Required)
# -----------------------------------------------------------------------------
# Mapbox - Get a free token at https://mapbox.com
MAPBOX_ACCESS_TOKEN=pk.your_mapbox_token_here

# Census Bureau API - Get a free key at https://api.census.gov/data/key_signup.html
CENSUS_API_KEY=your_census_api_key_here

# -----------------------------------------------------------------------------
# API Keys (Optional)
# -----------------------------------------------------------------------------
# BLS API - Increases rate limits, get at https://www.bls.gov/developers/
BLS_API_KEY=

# OpenAI - For AI-powered analysis features
OPENAI_API_KEY=
OPENAI_MODEL=gpt-5.1-mini
# Token budget for chat/extraction responses
OPENAI_MAX_TOKENS=4000
# Feature flag: controls AI routes/capabilities exposure
AI_ENABLED=false

# Sentry - Error tracking (optional)
SENTRY_DSN=

# -----------------------------------------------------------------------------
# Environment Settings
# -----------------------------------------------------------------------------
ENVIRONMENT=development
LOG_LEVEL=INFO
CORS_ALLOW_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# Data refresh settings
AUTO_REFRESH_ENABLED=true
REFRESH_TIMEZONE=America/New_York

# Export directory (relative to project root)
EXPORT_DIR=./exports
# Optional explicit frontend->API base URL override (used by frontend/runtime-config.js)
ATLAS_API_BASE_URL=

# -----------------------------------------------------------------------------
# Optional Data Enrichment Sources (local path or URL)
# -----------------------------------------------------------------------------
# Census QWI (job dynamics)
CENSUS_QWI_DATA_PATH=
CENSUS_QWI_DATA_URL=

# HUD Fair Market Rents (FMR)
HUD_FMR_DATA_PATH=
HUD_FMR_DATA_URL=
# HUD LIHTC project database
HUD_LIHTC_DATA_PATH=
HUD_LIHTC_DATA_URL=

# USPS Vacancy (HUD USPS)
USPS_VACANCY_DATA_PATH=
USPS_VACANCY_DATA_URL=
# ZIP -> County crosswalk for USPS data (required if only ZIPs provided)
USPS_ZIP_COUNTY_CROSSWALK_PATH=
USPS_ZIP_COUNTY_CROSSWALK_URL=

# Census ZIP -> County crosswalk (no login required)
CENSUS_ZIP_COUNTY_CROSSWALK_URL=

# HUD USPS API (crosswalk API)
HUD_USPS_API_URL=

# HUD Low Vacancy Counties (FY list)
LOW_VACANCY_COUNTIES_URL=
LOW_VACANCY_COUNTIES_PATH=

# Prediction alignment
LODES_LATEST_YEAR=2022
LODES_LAG_YEARS=2
# Optional LODES OD (Origin-Destination) file for county commute-flow derivations
# Example local path:
# LODES_OD_DATA_PATH=/Users/you/Downloads/od_JT00_*.csv
LODES_OD_DATA_PATH=
LODES_OD_DATA_URL=
LODES_OD_CHUNK_SIZE=500000
LODES_OD_TABLE=layer1_lodes_od_raw
ACS_LATEST_YEAR=2024
ACS_GEOGRAPHY_MAX_YEAR=2022
NCES_OBSERVED_MAX_YEAR=2024
PREDICT_TO_YEAR=2025
PREDICTION_MIN_YEARS=3
PREDICTION_MAX_EXTRAP_YEARS=2
USE_EFFECTIVE_VALUES=false

# Layer 1 accessibility mode: auto | network | proxy
LAYER1_ACCESSIBILITY_MODE=auto
# Accessibility thresholds (minutes)
LAYER1_THRESHOLD_30_MINUTES=30
LAYER1_THRESHOLD_45_MINUTES=45
# Proxy-only straight-line thresholds (km)
LAYER1_PROXY_DISTANCE_30_KM=20
LAYER1_PROXY_DISTANCE_45_KM=35
# Network-mode representative commute departure time
LAYER1_NETWORK_DEPARTURE_HOUR=8
LAYER1_NETWORK_DEPARTURE_MINUTE=0

# Risk drag penalty (caps over-penalization in composite score)
RISK_DRAG_PENALTY_FLOOR=0.5
